from shareplum import Site
from shareplum import Office365

# SharePoint site URL
site_url = "https://your-sharepoint-site.sharepoint.com/sites/YourSite"

# Credentials
username = "your_username@yourcompany.com"
password = "your_password"
domain = "yourcompany.com"

# Initialize Office365 session
authcookie = Office365(site_url, username=username, password=password).GetCookies()

# Connect to SharePoint site
site = Site(site_url, authcookie=authcookie)

# Specify the SharePoint list name
list_name = "YourListName"

# Get the SharePoint list data
data = site.List(list_name)

# Print the data
for item in data:
    print(item)
